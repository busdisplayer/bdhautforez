<! DOCTYPE html>
<html lang="fr">
<head>
  <title>Bd du Ht Forez - Transports en commun</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
  <script>
    const fetch = require("node-fetch"); // Nécessaire pour un environnement Node.js

// Fonction pour récupérer l'année actuelle et formater l'URL
function getApiUrl() {
    const currentYear = new Date().getFullYear();
    return `https://data.education.gouv.fr/api/explore/v2.1/catalog/datasets/fr-en-calendrier-scolaire/records?limit=20&refine=start_date%3A%22${currentYear}%22&refine=zones%3A%22Zone%20A%22&refine=location%3A%22Lyon%22&refine=population%3A%22-%22`;
}

// Fonction pour récupérer les vacances et déterminer l'état du jour
async function getVacationStatus() {
    const url = getApiUrl();
    try {
        const response = await fetch(url);
        const data = await response.json();
        if (!data.results) throw new Error("Données non disponibles");

        const today = new Date();
        const dayOfWeek = today.getDay(); // 0 = Dimanche, 6 = Samedi
        let status = "Semaine scolaire"; // Valeur par défaut

        // Vérifie si aujourd'hui est un mercredi
        const isWednesday = dayOfWeek === 3;

        // Vérifie si aujourd'hui est un week-end
        if (dayOfWeek === 0 || dayOfWeek === 6) {
            status = dayOfWeek === 0 ? "Dimanche" : "Samedi";
        }

        // Vérifie si aujourd'hui est un jour férié (exemple rapide, à améliorer avec une API dédiée)
        const publicHolidays = ["2025-01-01", "2025-05-01", "2025-07-14", "2025-12-25"]; // Ajouter d'autres dates
        const todayStr = today.toISOString().split("T")[0];
        if (publicHolidays.includes(todayStr)) {
            status = "Jour férié";
        }

        // Vérifie si aujourd'hui est une période de vacances
        for (const vacation of data.results) {
            const startDate = new Date(vacation.start_date);
            const endDate = new Date(vacation.end_date);
            if (today >= startDate && today <= endDate) {
                status = vacation.description === "Vacances d'Été" ? "Vacances d'été" : "Semaine de vacances scolaires";
                break;
            }
        }

        console.log(`Aujourd'hui, nous sommes : ${status}`);
        if (isWednesday) console.log("Note : Aujourd'hui est un mercredi.");
    } catch (error) {
        console.error("Erreur lors de la récupération des données :", error);
    }
}

// Exécute la fonction
getVacationStatus();
  </script>
</body>
</html>
